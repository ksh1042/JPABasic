# JPA Basic traning
- 김영한 - 자바 ORM 표준 JPA 프로그래밍

### 몰랐던 부분의 핵심 메모
- 엔티티 매니저
> &nbsp;JPA는 사용자 요청시 엔티티 매니저 팩토리로부터 생성된 엔티티 매니저 단위로 트랜잭션을 생성하여 데이터를 관리한다.<br>
> 보통 사용자 요청수행이 완료되면 해당 엔티티 매니저는 그와 동시에 종료될때 자원을 반환해야 한다.
> ※ 엔티티 매니저는 Autocloseable 인터페이스를 지원하지 않으므로 try-with-resource 를 통한 예외 처리가 불가하며, 

- 엔티티 매니저 팩토리
> &nbsp;어플리케이션 단위로 엔티티 매니저를 생성하는 팩토리 클래스이며, 무언가의 비즈니스 로직에 의해 요청이 들어올 경우 엔티티 매니저를 생성하는 역할이다.<br>
> ※ 엔티티 매니저 팩토리는 어플리케이션 기동 중 생성되며 어플리케이션 종료 시 자원을 반환해야 한다.

- 지연쓰기
> &nbsp;각 동작이 호출될 때에 즉시 실행하지 않고 명령을 모아두었다 flush & commit 발생 시 명령을 한꺼번에 수행한다.<br>
> ※ persistence.xml 혹은 application.yml 등의 설정파일에서 hibernate.jdbc.batch_size 값을 변경하여 지연쓰기에 사용될 공간의 크기를 지정이 가능하다.

- 엔티티 영속성 라이프 사이클
> 기본적으로 JDBC, SQL Mapper 등을 통해 DB에 영속적으로 저장하는 라이프 사이클과 유사하다. 하지만 JPA 에선 객체지향적인 개발을 위해 영속성 컨텍스트 개념이 존재해 상이한 부분이 존재한다.

- 영속성 컨텍스트
> &nbsp;일종의 어플리케이션에서 트랜잭션 단위로 데이터의 일관성을 보장해주는 1차 캐시와 비슷한 개념<br>
>> 비영속 : 영속적이지 않은 상태(어플리케이션 내에 객체를 처음 생성한 경우, transient 필드로 serializable 하지 않은 필드 등...)<br>
>> 영속(managed) : 영속성 컨텍스트에 관리되고 있는 상태(persist(), find()등으로 영속성 컨텍스트에서 관리되고 있는 상태)<br>
>> 준영속(detached) : 영속성 컨텍스트에 저장되어있다 분리된 상태<br>
>> 삭제 : 삭제된 상태

- 영속성 컨텍스트 스냅샷(flush, commit)
> 플러시 발생 시 변경을 감지한다.<br>
> 엔티티 매니저를 직접 사용할 경우에는 직접 호출명시 가능 하나, 
> 트랜잭션 커밋이 발생하거나, JPQL 실행시엔 자동으로 호출된다.

